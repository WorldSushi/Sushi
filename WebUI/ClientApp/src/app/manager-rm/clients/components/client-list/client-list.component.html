<mat-card class="mat-elevation-z1">
  <mat-card-header>
    <mat-card-title class="card-title">Клиенты</mat-card-title>
    <select class="archiv" [(ngModel)]="dateCollection" (ngModelChange)="toFormatDate(dateCollection)">
      <option *ngFor="let dateCollection of dateCollections">{{dateCollection}}</option>
    </select>
  </mat-card-header>

  <div class="filter clearfix">
    <a class="report" href="ReportManager?name=Nomll">Отчёт Номенклатура</a>
    <a class="report" href="ReportManager?name=Salle">Отчёт Анализ продаж</a>
    <a class="report" href="ReportManager?name=Opros">Отчёт По опросу</a>
    <a class="report" href="ReportManager?name=Debitory">Отчёт По дебиторке</a>
    <a class="report" href="ReportManager?name=Oxvat">Светофор</a>
    <select [(ngModel)]="selectedGroup" (change)="selectedWorkGroupChange()">
      <option [ngValue]=-10>Все рабочие групы</option>
      <option *ngFor="let wg of workgroup; let i = index" [ngValue]=i>
        {{wg.title}}
      </option>
    </select>
    <input (keyup)="applyFilter($event.target.value)" placeholder="Поиск">
    <p style="width:50px;margin-left:10px;background-color:#e9e2f8;" *ngIf="todayCalss.length">{{todayCalss.length}}</p>
  </div>
  <div class="filter clearfix">
  </div>
  <div [hidden]="hidenDivFull">

    <mat-card-content style="background-color:#f7f7f7">

      <!--<span style="font-family:Roboto,Helvetica Neue,sans-serif;font-size:14pt;margin:15px;">Актуальные</span>-->
      <table mat-table>

        <ng-container matColumnDef="status">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1"></td>
        </ng-container>

        <ng-container matColumnDef="elect">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1"></td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th colspan="2" mat-header-cell *matHeaderCellDef></th>
          <td colspan="2"></td>
        </ng-container>

        <ng-container matColumnDef="phone">
          <th colspan="2" mat-header-cell *matHeaderCellDef></th>
          <td colspan="2"></td>
        </ng-container>

        <ng-container matColumnDef="nomenclatureAnalysis">
          <th colspan="2" mat-header-cell *matHeaderCellDef></th>
          <td colspan="2"></td>
        </ng-container>

        <ng-container matColumnDef="callPlan.collective">
          <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План<br />{{getCountPlanCall(-10, 0)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="callPlan.MS">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС<br />{{getCountPlanCall(-10, 20)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="callPlan.RM">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ<br />{{getCountPlanCall(-10, 10)}}</th>
          <td mat-cell> </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.planned">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План<br />{{getCountPlanTrip(-10, 0)}}</th>
          <td mat-cell> </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.fact">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт<br />{{getCountPlanTrip(-10, 10)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="MSplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef></th>
          <td colspan="5"></td>
        </ng-container>

        <ng-container matColumnDef="RMplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef></th>
          <td colspan="5"></td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br />{{getCountCall(-10, 110)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br />{{getCountCall(-10, 120)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br />{{getCountCall(-10, 10)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br />{{getCountCall(-10, 20)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="MSresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br />{{getCountCall(-10, 30)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="RMresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br />{{getCountCall(-10, 40)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br />{{getCountCall(-10, 50)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br />{{getCountCall(-10, 60)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="MSresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br />{{getCountCall(-10, 70)}}</th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="RMresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br />{{getCountCall(-10, 80)}}</th>
          <td mat-cell> </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Share">
          <th mat-header-cell *matHeaderCellDef><!--МС<br />{{getCountCall(-10, 90).toFixed()}}%--></th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Share">
          <th mat-header-cell *matHeaderCellDef><!--РМ<br />{{getCountCall(-10, 100).toFixed()}}%--></th>
          <td mat-cell></td>
        </ng-container>

        <ng-container matColumnDef="colum1">
          <th mat-header-cell *matHeaderCellDef  colspan="4"></th>
          <td mat-cell *matCellDef="let element" colspan="4">
          </td>
        </ng-container>

        <ng-container matColumnDef="colum2">
          <th mat-header-cell *matHeaderCellDef  colspan="4"></th>
          <td mat-cell *matCellDef="let element" colspan="4">
          </td>
        </ng-container>

        <ng-container matColumnDef="colum3">
          <th mat-header-cell *matHeaderCellDef  colspan="4"></th>
          <td mat-cell *matCellDef="let element" colspan="4">
          </td>
        </ng-container>

        <ng-container matColumnDef="filler">
          <th mat-header-cell *matHeaderCellDef
              [style.text-align]="center"
              [attr.colspan]="6"></th>
        </ng-container>

        <ng-container matColumnDef="allCalls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки</th>
        </ng-container>

        <ng-container matColumnDef="trips">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
        </ng-container>

        <ng-container matColumnDef="todos">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="10"></th>
        </ng-container>

        <ng-container matColumnDef="allResultsAndMsg">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
        </ng-container>

        <ng-container matColumnDef="allResults">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки 2.5 мин </th>
        </ng-container>

        <ng-container matColumnDef="calls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития</th>
        </ng-container>

        <ng-container matColumnDef="Message">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма </th>
        </ng-container>

        <ng-container matColumnDef="WhatsApp">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
        </ng-container>

        <ng-container matColumnDef="Share">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2"><!--Доля %--></th>
        </ng-container>

        <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos', 'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>
      </table>

    </mat-card-content>

    <mat-card-content style="background-color:#f7f7f7" *ngIf="actual.data.length">

      <span style="font-family:Roboto,Helvetica Neue,sans-serif;font-size:14pt;margin:15px;">Актуальные</span>
      <table mat-table [dataSource]="actual" [trackBy]="getTrackBy">

        <ng-container matColumnDef="status">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1" mat-cell *matCellDef="let element" [style.background]="setBagroundStatus(element)" (click)="OpenCorrectionResponse(element.id, element.title)"></td>
        </ng-container>

        <ng-container matColumnDef="elect">
          <th [attr.colspan]="1" mat-header-cell *matHeaderCellDef>Кр. Клиент</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="1" mat-cell *matCellDef="let element" style="color: #324A60"> <input (click)="checkFluency(element)" *ngIf="!element.isCoverage" type="checkbox" />  <input (click)="checkFluency(element)" *ngIf="element.isCoverage" checked type="checkbox" /> </td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Название</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" style="color: #324A60">{{element.title}} </td>
        </ng-container>

        <ng-container matColumnDef="phone">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Телефон</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element">{{element.phones[0]?.phone}} </td>
        </ng-container>

        <ng-container matColumnDef="nomenclatureAnalysis">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Номен-ра</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" (click)="openNomenclatureAnalysis(element)">
            <div class="bar-shadow">
              <div class="bar"
                   [style.background-color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).background"
                   [style.color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).font"
                   [style.width.px]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).width">
                <b>{{getAvgAnalysis(element.nomenclatureAnalysis)}}%</b>
              </div>
            </div>
          </td>
        </ng-container>

        <!--<ng-container matColumnDef="revenueAnalysis">
    <th mat-header-cell *matHeaderCellDef>Выручка</th>
    <td mat-cell *matCellDef="let element"
    (click)="openRevenueAnalysis(element)">
    <div class="bar-shadow">
        <div class="bar"
        [style.background-color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).background"
        [style.color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).font"
        [style.width.px]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).width">
          <b>
            {{getAvgAnalysis(element.revenueAnalysis)}}%
          </b>
        </div>
    </div>
  </td>
  </ng-container>-->

        <ng-container matColumnDef="callPlan.collective">
          <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План<br /></th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">{{element.callPlan?.totalCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.MS">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.callPlan.escortManagerCalls" style="font-weight: bold; color: #61717e" (focusout)="updateCallPlan(element.callPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.RM">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element" style="font-weight: bold; color: #61717e">{{element.callPlan?.regionalManagerCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.planned">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.tripPlan.hours" (focusout)="updateTripPlanHours(element.tripPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.fact">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <mat-select [(ngModel)]="element.tripPlan.completedType" (selectionChange)="updateTripPlanCompletedType(element.tripPlan)">
                <mat-option [value]="30">1</mat-option>
                <mat-option [value]="20">0.5</mat-option>
                <mat-option [value]="10">0.3</mat-option>
                <mat-option [value]="0">0</mat-option>
              </mat-select>
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="MSplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #f0fbff">План</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentMsPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #e3f7ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentRmPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br /></th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br /></th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br /></th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br /></th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС<br /></th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br /></th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ<br /></th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="colum1">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(0)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type != 1" [value]="element.directions.table1" (focusout)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type == 1" [(ngModel)]="element.directions.table1Optin" (change)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)">
              <option *ngFor="let table1Optin of element.directions.table1Optins; let i = index" [value]="i">{{table1Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum2">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(1)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type != 1" [value]="element.directions.table2" (focusout)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type == 1" [(ngModel)]="element.directions.table2Optin" (change)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)">
              <option *ngFor="let table2Optin of element.directions.table2Optins; let i = index" [value]="i">{{table2Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum3" >
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(2)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type != 1" [value]="element.directions.table3" (focusout)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type == 1" [(ngModel)]="element.directions.table3Optin" (change)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)">
              <option *ngFor="let table3Optin of element.directions.table3Optins; let i = index" [value]="i">{{table3Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="filler">
          <th mat-header-cell *matHeaderCellDef
              [style.text-align]="center"
              [attr.colspan]="6"
              style="background-color: #fff"></th>
        </ng-container>

        <ng-container matColumnDef="allCalls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки </th>
        </ng-container>

        <ng-container matColumnDef="trips">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
        </ng-container>

        <ng-container matColumnDef="todos">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="10" style="text-align: center; background-color: #d7f5ff; color: #94c3cb">План и факт по задачам - {{getTypeManager() == 10 ? "МС" : getTypeManager() == 20 ? "РМ"  : "--"}} - {{manager.login}} </th>
        </ng-container>

        <ng-container matColumnDef="allResultsAndMsg">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
        </ng-container>

        <ng-container matColumnDef="allResults">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки 2.5 минут </th>
        </ng-container>

        <ng-container matColumnDef="calls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития</th>
        </ng-container>

        <ng-container matColumnDef="Message">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма </th>
        </ng-container>

        <ng-container matColumnDef="WhatsApp">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
        </ng-container>

        <ng-container matColumnDef="Share">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Доля %</th>
        </ng-container>

        <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos',  'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>
      </table>

    </mat-card-content>

    <mat-card-content style="background-color:#f7f7f7" *ngIf="recordShipment.data.length">

      <span style="font-family:Roboto,Helvetica Neue,sans-serif;font-size:14pt;margin:15px;">С редкой отгрузкой</span>
      <table mat-table [dataSource]="recordShipment" [trackBy]="getTrackBy">

        <ng-container matColumnDef="elect">
          <th [attr.colspan]="1" mat-header-cell *matHeaderCellDef>Кр. Клиент</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="1" mat-cell *matCellDef="let element" style="color: #324A60"> <input (click)="checkFluency(element)" *ngIf="!element.isCoverage" type="checkbox" />  <input (click)="checkFluency(element)" *ngIf="element.isCoverage" checked type="checkbox" /> </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1" mat-cell *matCellDef="let element" [style.background]="setBagroundStatus(element)" (click)="OpenCorrectionResponse(element.id, element.title)"></td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Название</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" style="color: #324A60">{{element.title}} </td>
        </ng-container>

        <ng-container matColumnDef="phone">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Телефон</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element">{{element.phones[0]?.phone}} </td>
        </ng-container>

        <ng-container matColumnDef="nomenclatureAnalysis">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Номен-ра</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" (click)="openNomenclatureAnalysis(element)">
            <div class="bar-shadow">
              <div class="bar"
                   [style.background-color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).background"
                   [style.color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).font"
                   [style.width.px]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).width">
                <b>{{getAvgAnalysis(element.nomenclatureAnalysis)}}%</b>
              </div>
            </div>
          </td>
        </ng-container>

        <!--<ng-container matColumnDef="revenueAnalysis">
    <th mat-header-cell *matHeaderCellDef>Выручка</th>
    <td mat-cell *matCellDef="let element"
    (click)="openRevenueAnalysis(element)">
    <div class="bar-shadow">
        <div class="bar"
        [style.background-color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).background"
        [style.color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).font"
        [style.width.px]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).width">
          <b>
            {{getAvgAnalysis(element.revenueAnalysis)}}%
          </b>
        </div>
    </div>
  </td>
  </ng-container>-->

        <ng-container matColumnDef="callPlan.collective">
          <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">{{element.callPlan?.totalCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.MS">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.callPlan.escortManagerCalls" style="font-weight: bold; color: #61717e" (focusout)="updateCallPlan(element.callPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.RM">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element" style="font-weight: bold; color: #61717e">{{element.callPlan?.regionalManagerCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.planned">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.tripPlan.hours" (focusout)="updateTripPlanHours(element.tripPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.fact">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <mat-select [(ngModel)]="element.tripPlan.completedType" (selectionChange)="updateTripPlanCompletedType(element.tripPlan)">
                <mat-option [value]="30">1</mat-option>
                <mat-option [value]="20">0.5</mat-option>
                <mat-option [value]="10">0.3</mat-option>
                <mat-option [value]="0">0</mat-option>
              </mat-select>
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="MSplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #f0fbff">Палан</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentMsPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #e3f7ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentRmPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="filler">
          <th mat-header-cell *matHeaderCellDef
              [style.text-align]="center"
              [attr.colspan]="6"
              style="background-color: #fff"></th>
        </ng-container>

        <ng-container matColumnDef="allCalls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки </th>
        </ng-container>

        <ng-container matColumnDef="trips">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
        </ng-container>

        <ng-container matColumnDef="todos">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="10" style="text-align: center; background-color: #d7f5ff; color: #94c3cb">План и факт по задачам - {{getTypeManager() == 10 ? "МС" : getTypeManager() == 20 ? "РМ"  : "--"}} - {{manager.login}}</th>
        </ng-container>

        <ng-container matColumnDef="allResultsAndMsg">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
        </ng-container>

        <ng-container matColumnDef="allResults">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки 2.5 мин</th>
        </ng-container>

        <ng-container matColumnDef="calls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития</th>
        </ng-container>

        <ng-container matColumnDef="Message">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма </th>
        </ng-container>

        <ng-container matColumnDef="WhatsApp">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
        </ng-container>

        <ng-container matColumnDef="Share">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Доля %</th>
        </ng-container>

        <ng-container matColumnDef="colum1">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(0)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type != 1" [value]="element.directions.table1" (focusout)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type == 1" [(ngModel)]="element.directions.table1Optin" (change)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)">
              <option *ngFor="let table1Optin of element.directions.table1Optins; let i = index" [value]="i">{{table1Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum2">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(1)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type != 1" [value]="element.directions.table2" (focusout)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type == 1" [(ngModel)]="element.directions.table2Optin" (change)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)">
              <option *ngFor="let table2Optin of element.directions.table2Optins; let i = index" [value]="i">{{table2Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum3">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(2)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type != 1" [value]="element.directions.table3" (focusout)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type == 1" [(ngModel)]="element.directions.table3Optin" (change)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)">
              <option *ngFor="let table3Optin of element.directions.table3Optins; let i = index" [value]="i">{{table3Optin}}</option>
            </select>
          </td>
        </ng-container>

        <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos', 'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>
      </table>

    </mat-card-content>

    <mat-card-content tyle="background-color:#f7f7f7" *ngIf="restaurants.data.length">

      <span style="font-family:Roboto,Helvetica Neue,sans-serif;font-size:14pt;margin:15px;">Рестораны</span>
      <table mat-table [dataSource]="restaurants" [trackBy]="getTrackBy">


        <ng-container matColumnDef="elect">
          <th [attr.colspan]="1" mat-header-cell *matHeaderCellDef>Кр. Клиент</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="1" mat-cell *matCellDef="let element" style="color: #324A60"> <input (click)="checkFluency(element)" *ngIf="!element.isCoverage" type="checkbox" />  <input (click)="checkFluency(element)" *ngIf="element.isCoverage" checked type="checkbox" /> </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1" mat-cell *matCellDef="let element" [style.background]="setBagroundStatus(element)" (click)="OpenCorrectionResponse(element.id, element.title)"></td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Название</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" style="color: #324A60">{{element.title}} </td>
        </ng-container>

        <ng-container matColumnDef="phone">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Телефон</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element">{{element.phones[0]?.phone}} </td>
        </ng-container>

        <ng-container matColumnDef="nomenclatureAnalysis">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Номен-ра</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" (click)="openNomenclatureAnalysis(element)">
            <div class="bar-shadow">
              <div class="bar"
                   [style.background-color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).background"
                   [style.color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).font"
                   [style.width.px]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).width">
                <b>{{getAvgAnalysis(element.nomenclatureAnalysis)}}%</b>
              </div>
            </div>
          </td>
        </ng-container>

        <!--<ng-container matColumnDef="revenueAnalysis">
    <th mat-header-cell *matHeaderCellDef>Выручка</th>
    <td mat-cell *matCellDef="let element"
    (click)="openRevenueAnalysis(element)">
    <div class="bar-shadow">
        <div class="bar"
        [style.background-color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).background"
        [style.color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).font"
        [style.width.px]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).width">
          <b>
            {{getAvgAnalysis(element.revenueAnalysis)}}%
          </b>
        </div>
    </div>
  </td>
  </ng-container>-->

        <ng-container matColumnDef="callPlan.collective">
          <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">{{element.callPlan?.totalCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.MS">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.callPlan.escortManagerCalls" style="font-weight: bold; color: #61717e" (focusout)="updateCallPlan(element.callPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.RM">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element" style="font-weight: bold; color: #61717e">{{element.callPlan?.regionalManagerCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.planned">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.tripPlan.hours" (focusout)="updateTripPlanHours(element.tripPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.fact">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <mat-select [(ngModel)]="element.tripPlan.completedType" (selectionChange)="updateTripPlanCompletedType(element.tripPlan)">
                <mat-option [value]="30">1</mat-option>
                <mat-option [value]="20">0.5</mat-option>
                <mat-option [value]="10">0.3</mat-option>
                <mat-option [value]="0">0</mat-option>
              </mat-select>
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="MSplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #f0fbff">План</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentMsPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #e3f7ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentRmPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="colum1">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(0)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type != 1" [value]="element.directions.table1" (focusout)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type == 1" [(ngModel)]="element.directions.table1Optin" (change)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)">
              <option style="width:auto;border:none;background:none;" *ngFor="let table1Optin of element.directions.table1Optins; let i = index" [value]="i">{{table1Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum2">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(1)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type != 1" [value]="element.directions.table2" (focusout)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type == 1" [(ngModel)]="element.directions.table2Optin" (change)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)">
              <option *ngFor="let table2Optin of element.directions.table2Optins; let i = index" [value]="i">{{table2Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum3">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(2)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type != 1" [value]="element.directions.table3" (focusout)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type == 1" [(ngModel)]="element.directions.table3Optin" (change)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)">
              <option *ngFor="let table3Optin of element.directions.table3Optins; let i = index" [value]="i">{{table3Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="filler">
          <th mat-header-cell *matHeaderCellDef
              [style.text-align]="center"
              [attr.colspan]="6"
              style="background-color: #fff"></th>
        </ng-container>

        <ng-container matColumnDef="allCalls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки </th>
        </ng-container>

        <ng-container matColumnDef="trips">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
        </ng-container>

        <ng-container matColumnDef="todos">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="10" style="text-align: center; background-color: #d7f5ff; color: #94c3cb">План и факт по задачам - {{getTypeManager() == 10 ? "МС" : getTypeManager() == 20 ? "РМ"  : "--"}} - {{manager.login}}</th>
        </ng-container>

        <ng-container matColumnDef="allResultsAndMsg">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
        </ng-container>

        <ng-container matColumnDef="allResults">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">звонки 2.5 мин</th>
        </ng-container>

        <ng-container matColumnDef="calls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития </th>
        </ng-container>

        <ng-container matColumnDef="Message">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма</th>
        </ng-container>

        <ng-container matColumnDef="WhatsApp">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
        </ng-container>

        <ng-container matColumnDef="Share">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Доля %</th>
        </ng-container>

        <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos', 'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>

      </table>

    </mat-card-content>

    <mat-card-content style="background-color:#f7f7f7" *ngIf="newOrResuscitating.data.length">

      <span style="font-family:Roboto,Helvetica Neue,sans-serif;font-size:14pt;margin:15px;">Новые или реанимируемые</span>
      <table mat-table [dataSource]="newOrResuscitating" [trackBy]="getTrackBy">

        <ng-container matColumnDef="status">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1" mat-cell *matCellDef="let element" [style.background]="setBagroundStatus(element)" (click)="OpenCorrectionResponse(element.id, element.title)"></td>
        </ng-container>

        <ng-container matColumnDef="elect">
          <th [attr.colspan]="1" mat-header-cell *matHeaderCellDef>Кр. Клиент</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="1" mat-cell *matCellDef="let element" style="color: #324A60"> <input (click)="checkFluency(element)" *ngIf="!element.isCoverage" type="checkbox" />  <input (click)="checkFluency(element)" *ngIf="element.isCoverage" checked type="checkbox" /> </td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Название</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" style="color: #324A60">{{element.title}} </td>
        </ng-container>

        <ng-container matColumnDef="phone">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Телефон</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element">{{element.phones[0]?.phone}} </td>
        </ng-container>

        <ng-container matColumnDef="nomenclatureAnalysis">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Номен-ра</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" (click)="openNomenclatureAnalysis(element)">
            <div class="bar-shadow">
              <div class="bar"
                   [style.background-color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).background"
                   [style.color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).font"
                   [style.width.px]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).width">
                <b>{{getAvgAnalysis(element.nomenclatureAnalysis)}}%</b>
              </div>
            </div>
          </td>
        </ng-container>

        <!--<ng-container matColumnDef="revenueAnalysis">
    <th mat-header-cell *matHeaderCellDef>Выручка</th>
    <td mat-cell *matCellDef="let element"
    (click)="openRevenueAnalysis(element)">
    <div class="bar-shadow">
        <div class="bar"
        [style.background-color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).background"
        [style.color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).font"
        [style.width.px]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).width">
          <b>
            {{getAvgAnalysis(element.revenueAnalysis)}}%
          </b>
        </div>
    </div>
  </td>
  </ng-container>-->


        <ng-container matColumnDef="callPlan.collective">
          <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">{{element.callPlan?.totalCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.MS">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.callPlan.escortManagerCalls" style="font-weight: bold; color: #61717e" (focusout)="updateCallPlan(element.callPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.RM">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element" style="font-weight: bold; color: #61717e">{{element.callPlan?.regionalManagerCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.planned">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.tripPlan.hours" (focusout)="updateTripPlanHours(element.tripPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.fact">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <mat-select [(ngModel)]="element.tripPlan.completedType" (selectionChange)="updateTripPlanCompletedType(element.tripPlan)">
                <mat-option [value]="30">1</mat-option>
                <mat-option [value]="20">0.5</mat-option>
                <mat-option [value]="10">0.3</mat-option>
                <mat-option [value]="0">0</mat-option>
              </mat-select>
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="MSplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #f0fbff">План</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentMsPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #e3f7ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentRmPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="colum1">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(0)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type != 1" [value]="element.directions.table1" (focusout)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type == 1" [(ngModel)]="element.directions.table1Optin" (change)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)">
              <option *ngFor="let table1Optin of element.directions.table1Optins; let i = index" [value]="i">{{table1Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum2">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(1)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type != 1" [value]="element.directions.table2" (focusout)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type == 1" [(ngModel)]="element.directions.table2Optin" (change)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)">
              <option *ngFor="let table2Optin of element.directions.table2Optins; let i = index" [value]="i">{{table2Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum3">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(2)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type != 1" [value]="element.directions.table3" (focusout)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type == 1" [(ngModel)]="element.directions.table3Optin" (change)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)">
              <option *ngFor="let table3Optin of element.directions.table3Optins; let i = index" [value]="i">{{table3Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="filler">
          <th mat-header-cell *matHeaderCellDef
              [style.text-align]="center"
              [attr.colspan]="6"
              style="background-color: #fff"></th>
        </ng-container>

        <ng-container matColumnDef="allCalls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки </th>
        </ng-container>

        <ng-container matColumnDef="trips">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
        </ng-container>

        <ng-container matColumnDef="todos">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="10" style="text-align: center; background-color: #d7f5ff; color: #94c3cb">План и факт по задачам - {{getTypeManager() == 10 ? "МС" : getTypeManager() == 20 ? "РМ"  : "--"}} - {{manager.login}}</th>
        </ng-container>

        <ng-container matColumnDef="allResultsAndMsg">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
        </ng-container>

        <ng-container matColumnDef="allResults">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки 2.5 мин</th>
        </ng-container>

        <ng-container matColumnDef="calls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития</th>
        </ng-container>

        <ng-container matColumnDef="Message">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма </th>
        </ng-container>

        <ng-container matColumnDef="WhatsApp">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
        </ng-container>

        <ng-container matColumnDef="Share">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Доля %</th>
        </ng-container>

        <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos', 'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>
      </table>

    </mat-card-content>

    <mat-card-content style="background-color:#f7f7f7" *ngIf="notDetermined.data.length">

      <span style="font-family:Roboto,Helvetica Neue,sans-serif;font-size:14pt;margin:15px;">Не опредиленные</span>
      <table mat-table [dataSource]="notDetermined" [trackBy]="getTrackBy">


        <ng-container matColumnDef="elect">
          <th [attr.colspan]="1" mat-header-cell *matHeaderCellDef>Кр. Клиент</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="1" mat-cell *matCellDef="let element" style="color: #324A60"> <input (click)="checkFluency(element)" *ngIf="!element.isCoverage" type="checkbox" />  <input (click)="checkFluency(element)" *ngIf="element.isCoverage" checked type="checkbox" /> </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1" mat-cell *matCellDef="let element" [style.background]="setBagroundStatus(element)" (click)="OpenCorrectionResponse(element.id, element.title)"></td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Название</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" style="color: #324A60">{{element.title}} </td>
        </ng-container>

        <ng-container matColumnDef="phone">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Телефон</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element">{{element.phones[0]?.phone}} </td>
        </ng-container>

        <ng-container matColumnDef="nomenclatureAnalysis">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Номен-ра</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" (click)="openNomenclatureAnalysis(element)">
            <div class="bar-shadow">
              <div class="bar"
                   [style.background-color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).background"
                   [style.color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).font"
                   [style.width.px]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).width">
                <b>{{getAvgAnalysis(element.nomenclatureAnalysis)}}%</b>
              </div>
            </div>
          </td>
        </ng-container>

        <!--<ng-container matColumnDef="revenueAnalysis">
    <th mat-header-cell *matHeaderCellDef>Выручка</th>
    <td mat-cell *matCellDef="let element"
    (click)="openRevenueAnalysis(element)">
    <div class="bar-shadow">
        <div class="bar"
        [style.background-color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).background"
        [style.color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).font"
        [style.width.px]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).width">
          <b>
            {{getAvgAnalysis(element.revenueAnalysis)}}%
          </b>
        </div>
    </div>
  </td>
  </ng-container>-->

        <ng-container matColumnDef="callPlan.collective">
          <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">{{element.callPlan?.totalCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.MS">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.callPlan.escortManagerCalls" style="font-weight: bold; color: #61717e" (focusout)="updateCallPlan(element.callPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.RM">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element" style="font-weight: bold; color: #61717e">{{element.callPlan?.regionalManagerCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.planned">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.tripPlan.hours" (focusout)="updateTripPlanHours(element.tripPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.fact">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <mat-select [(ngModel)]="element.tripPlan.completedType" (selectionChange)="updateTripPlanCompletedType(element.tripPlan)">
                <mat-option [value]="30">1</mat-option>
                <mat-option [value]="20">0.5</mat-option>
                <mat-option [value]="10">0.3</mat-option>
                <mat-option [value]="0">0</mat-option>
              </mat-select>
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="MSplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #f0fbff">План</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentMsPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #e3f7ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentRmPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="colum1">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(0)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type != 1" [value]="element.directions.table1" (focusout)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type == 1" [(ngModel)]="element.directions.table1Optin" (change)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)">
              <option *ngFor="let table1Optin of element.directions.table1Optins; let i = index" [value]="i">{{table1Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum2">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(1)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type != 1" [value]="element.directions.table2" (focusout)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type == 1" [(ngModel)]="element.directions.table2Optin" (change)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)">
              <option *ngFor="let table2Optin of element.directions.table2Optins; let i = index" [value]="i">{{table2Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum3">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(2)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type != 1" [value]="element.directions.table3" (focusout)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type == 1" [(ngModel)]="element.directions.table3Optin" (change)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)">
              <option *ngFor="let table3Optin of element.directions.table3Optins; let i = index" [value]="i">{{table3Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="filler">
          <th mat-header-cell *matHeaderCellDef
              [style.text-align]="center"
              [attr.colspan]="6"
              style="background-color: #fff"></th>
        </ng-container>

        <ng-container matColumnDef="allCalls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки </th>
        </ng-container>

        <ng-container matColumnDef="trips">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
        </ng-container>

        <ng-container matColumnDef="todos">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="10" style="text-align: center; background-color: #d7f5ff; color: #94c3cb">План и факт по задачам - {{getTypeManager() == 10 ? "МС" : getTypeManager() == 20 ? "РМ"  : "--"}} - {{manager.login}}</th>
        </ng-container>

        <ng-container matColumnDef="allResultsAndMsg">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
        </ng-container>

        <ng-container matColumnDef="allResults">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки 2.5 мин</th>
        </ng-container>

        <ng-container matColumnDef="calls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития</th>
        </ng-container>

        <ng-container matColumnDef="Message">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма </th>
        </ng-container>

        <ng-container matColumnDef="WhatsApp">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
        </ng-container>

        <ng-container matColumnDef="Share">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Доля %</th>
        </ng-container>

        <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos', 'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>

      </table>
    </mat-card-content>


    <mat-card-content style="background-color:#f7f7f7" *ngIf="other.data.length">

      <span style="font-family:Roboto,Helvetica Neue,sans-serif;font-size:14pt;margin:15px;">Другие</span>
      <table mat-table [dataSource]="other" [trackBy]="getTrackBy">

        <ng-container matColumnDef="elect">
          <th [attr.colspan]="1" mat-header-cell *matHeaderCellDef>Кр. Клиент</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="1" mat-cell *matCellDef="let element" style="color: #324A60"> <input (click)="checkFluency(element)" *ngIf="!element.isCoverage" type="checkbox" />  <input (click)="checkFluency(element)" *ngIf="element.isCoverage" checked type="checkbox" /> </td>
        </ng-container>

        <ng-container matColumnDef="status">
          <th colspan="1" mat-header-cell *matHeaderCellDef></th>
          <td colspan="1" mat-cell *matCellDef="let element" [style.background]="setBagroundStatus(element)" (click)="OpenCorrectionResponse(element.id, element.title)"></td>
        </ng-container>

        <ng-container matColumnDef="title">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Название</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" style="color: #324A60">{{element.title}} </td>
        </ng-container>

        <ng-container matColumnDef="phone">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Телефон</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element">{{element.phones[0]?.phone}} </td>
        </ng-container>

        <ng-container matColumnDef="nomenclatureAnalysis">
          <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Номен-ра</th>
          <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" (click)="openNomenclatureAnalysis(element)">
            <div class="bar-shadow">
              <div class="bar"
                   [style.background-color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).background"
                   [style.color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).font"
                   [style.width.px]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).width">
                <b>{{getAvgAnalysis(element.nomenclatureAnalysis)}}%</b>
              </div>
            </div>
          </td>
        </ng-container>

        <!--<ng-container matColumnDef="revenueAnalysis">
    <th mat-header-cell *matHeaderCellDef>Выручка</th>
    <td mat-cell *matCellDef="let element"
    (click)="openRevenueAnalysis(element)">
    <div class="bar-shadow">
        <div class="bar"
        [style.background-color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).background"
        [style.color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).font"
        [style.width.px]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).width">
          <b>
            {{getAvgAnalysis(element.revenueAnalysis)}}%
          </b>
        </div>
    </div>
  </td>
  </ng-container>-->

        <ng-container matColumnDef="callPlan.collective">
          <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">{{element.callPlan?.totalCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.MS">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.callPlan.escortManagerCalls" style="font-weight: bold; color: #61717e" (focusout)="updateCallPlan(element.callPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="callPlan.RM">
          <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element" style="font-weight: bold; color: #61717e">{{element.callPlan?.regionalManagerCalls}} </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.planned">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <input matInput [(ngModel)]="element.tripPlan.hours" (focusout)="updateTripPlanHours(element.tripPlan)" />
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="tripPlan.fact">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
            <mat-form-field class="numberInputField">
              <mat-select [(ngModel)]="element.tripPlan.completedType" (selectionChange)="updateTripPlanCompletedType(element.tripPlan)">
                <mat-option [value]="30">1</mat-option>
                <mat-option [value]="20">0.5</mat-option>
                <mat-option [value]="10">0.3</mat-option>
                <mat-option [value]="0">0</mat-option>
              </mat-select>
            </mat-form-field>
          </td>
        </ng-container>

        <ng-container matColumnDef="MSplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #f0fbff">План</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentMsPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMplanned">
          <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #e3f7ff">Факт</th>
          <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
            {{getCurrentRmPlan(element.weekPlans)}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sumAndMsg">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalResAndMsg}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.sum">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalTotalContacts}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.call">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalCalls}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Message">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalMails}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
            {{element.managerCallsResults.escortLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.WhatsApp">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
            {{element.managerCallsResults.regionalLetters}}
          </td>
        </ng-container>

        <ng-container matColumnDef="MSresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
          <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.escortRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="RMresults.Share">
          <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
          <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
            {{element.managerCallsResults.regionalRes}}
          </td>
        </ng-container>

        <ng-container matColumnDef="colum1">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(0)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type != 1" [value]="element.directions.table1" (focusout)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type == 1" [(ngModel)]="element.directions.table1Optin" (change)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)">
              <option *ngFor="let table1Optin of element.directions.table1Optins; let i = index" [value]="i">{{table1Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum2">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(1)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type != 1" [value]="element.directions.table2" (focusout)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type == 1" [(ngModel)]="element.directions.table2Optin" (change)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)">
              <option *ngFor="let table2Optin of element.directions.table2Optins; let i = index" [value]="i">{{table2Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="colum3">
          <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(2)}}</th>
          <td mat-cell *matCellDef="let element" colspan="4">
            <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type != 1" [value]="element.directions.table3" (focusout)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)"></textarea>

            <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type == 1" [(ngModel)]="element.directions.table3Optin" (change)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)">
              <option *ngFor="let table3Optin of element.directions.table3Optins; let i = index" [value]="i">{{table3Optin}}</option>
            </select>
          </td>
        </ng-container>

        <ng-container matColumnDef="filler">
          <th mat-header-cell *matHeaderCellDef
              [style.text-align]="center"
              [attr.colspan]="6"
              style="background-color: #fff"></th>
        </ng-container>

        <ng-container matColumnDef="allCalls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки </th>
        </ng-container>

        <ng-container matColumnDef="trips">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
        </ng-container>

        <ng-container matColumnDef="todos">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="10" style="text-align: center; background-color: #d7f5ff; color: #94c3cb">План и факт по задачам - {{getTypeManager() == 10 ? "МС" : getTypeManager() == 20 ? "РМ"  : "--"}} - {{manager.login}}</th>
        </ng-container>

        <ng-container matColumnDef="allResultsAndMsg">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
        </ng-container>

        <ng-container matColumnDef="allResults">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки 2.5 мин</th>
        </ng-container>

        <ng-container matColumnDef="calls">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития</th>
        </ng-container>

        <ng-container matColumnDef="Message">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма </th>
        </ng-container>

        <ng-container matColumnDef="WhatsApp">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
        </ng-container>

        <ng-container matColumnDef="Share">
          <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Доля %</th>
        </ng-container>

        <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos', 'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>
      </table>

    </mat-card-content>

  </div>

    <div [hidden]="hidenDivSrrch">
      <mat-card-content>
        <mat-paginator [pageSize]="50" [pageSizeOptions]="[50, 100, 150]"></mat-paginator>

        <table mat-table [dataSource]="dataSource" [trackBy]="getTrackBy">


          <ng-container matColumnDef="elect">
            <th [attr.colspan]="1" mat-header-cell *matHeaderCellDef>Кр. Клиент</th>
            <td [style.background]="checkCallForColor(element)" [attr.colspan]="1" mat-cell *matCellDef="let element" style="color: #324A60"> <input (click)="checkFluency(element)" *ngIf="!element.isCoverage" type="checkbox" />  <input (click)="checkFluency(element)" *ngIf="element.isCoverage" checked type="checkbox" /> </td>
          </ng-container>

          <ng-container matColumnDef="status">
            <th colspan="1" mat-header-cell *matHeaderCellDef></th>
            <td colspan="1" mat-cell *matCellDef="let element" [style.background]="setBagroundStatus(element)" (click)="OpenCorrectionResponse(element.id, element.title)"></td>
          </ng-container>

          <ng-container matColumnDef="title">
            <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Название</th>
            <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" style="color: #324A60">{{element.title}} </td>
          </ng-container>

          <ng-container matColumnDef="phone">
            <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Телефон</th>
            <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element">{{element.phones[0]?.phone}} </td>
          </ng-container>

          <ng-container matColumnDef="nomenclatureAnalysis">
            <th [attr.colspan]="2" mat-header-cell *matHeaderCellDef>Номен-ра</th>
            <td [style.background]="checkCallForColor(element)" [attr.colspan]="2" mat-cell *matCellDef="let element" (click)="openNomenclatureAnalysis(element)">
              <div class="bar-shadow">
                <div class="bar"
                     [style.background-color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).background"
                     [style.color]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).font"
                     [style.width.px]="getAnalysisProps(getAvgAnalysis(element.nomenclatureAnalysis)).width">
                  <b>{{getAvgAnalysis(element.nomenclatureAnalysis)}}%</b>
                </div>
              </div>
            </td>
          </ng-container>

          <!--<ng-container matColumnDef="revenueAnalysis">
    <th mat-header-cell *matHeaderCellDef>Выручка</th>
    <td mat-cell *matCellDef="let element"
    (click)="openRevenueAnalysis(element)">
    <div class="bar-shadow">
        <div class="bar"
        [style.background-color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).background"
        [style.color]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).font"
        [style.width.px]="getAnalysisProps(getAvgAnalysis(element.revenueAnalysis)).width">
          <b>
            {{getAvgAnalysis(element.revenueAnalysis)}}%
          </b>
        </div>
    </div>
  </td>
  </ng-container>-->

          <ng-container matColumnDef="callPlan.collective">
            <th mat-header-cell *matHeaderCellDef style="background-color: #fdf6fd">План</th>
            <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">{{element.callPlan?.totalCalls}} </td>
          </ng-container>

          <ng-container matColumnDef="callPlan.MS">
            <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">МС</th>
            <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
              <mat-form-field class="numberInputField">
                <input matInput [(ngModel)]="element.callPlan.escortManagerCalls" style="font-weight: bold; color: #61717e" (focusout)="updateCallPlan(element.callPlan)" />
              </mat-form-field>
            </td>
          </ng-container>

          <ng-container matColumnDef="callPlan.RM">
            <th mat-header-cell *matHeaderCellDef style="background-color: #ffeeff">РМ</th>
            <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element" style="font-weight: bold; color: #61717e">{{element.callPlan?.regionalManagerCalls}} </td>
          </ng-container>

          <ng-container matColumnDef="tripPlan.planned">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f7f8fd">План</th>
            <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
              <mat-form-field class="numberInputField">
                <input matInput [(ngModel)]="element.tripPlan.hours" (focusout)="updateTripPlanHours(element.tripPlan)" />
              </mat-form-field>
            </td>
          </ng-container>

          <ng-container matColumnDef="tripPlan.fact">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f0f4ff">Факт</th>
            <td [style.background]="checkCallForColor(element)" mat-cell *matCellDef="let element">
              <mat-form-field class="numberInputField">
                <mat-select [(ngModel)]="element.tripPlan.completedType" (selectionChange)="updateTripPlanCompletedType(element.tripPlan)">
                  <mat-option [value]="30">1</mat-option>
                  <mat-option [value]="20">0.5</mat-option>
                  <mat-option [value]="10">0.3</mat-option>
                  <mat-option [value]="0">0</mat-option>
                </mat-select>
              </mat-form-field>
            </td>
          </ng-container>

          <ng-container matColumnDef="MSplanned">
            <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #f0fbff">План</th>
            <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
              {{getCurrentMsPlan(element.weekPlans)}}
            </td>
          </ng-container>

          <ng-container matColumnDef="RMplanned">
            <th colspan="5" mat-header-cell *matHeaderCellDef style="background-color: #e3f7ff">Факт</th>
            <td [style.background]="checkCallForColor(element)" colspan="5" mat-cell *matCellDef="let element" (click)="openWeekPlans(element)">
              {{getCurrentRmPlan(element.weekPlans)}}
            </td>
          </ng-container>

          <ng-container matColumnDef="MSresults.sumAndMsg">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
              {{element.managerCallsResults.escortResAndMsg}}
            </td>
          </ng-container>

          <ng-container matColumnDef="RMresults.sumAndMsg">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
              {{element.managerCallsResults.regionalResAndMsg}}
            </td>
          </ng-container>

          <ng-container matColumnDef="MSresults.sum">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
            <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
              {{element.managerCallsResults.escortTotalContacts}}
            </td>
          </ng-container>

          <ng-container matColumnDef="RMresults.sum">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
            <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
              {{element.managerCallsResults.regionalTotalContacts}}
            </td>
          </ng-container>


          <ng-container matColumnDef="MSresults.call">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
              {{element.managerCallsResults.escortCalls}}
            </td>
          </ng-container>

          <ng-container matColumnDef="RMresults.call">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
              {{element.managerCallsResults.regionalCalls}}
            </td>
          </ng-container>

          <ng-container matColumnDef="MSresults.Message">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
              {{element.managerCallsResults.escortMails}}
            </td>
          </ng-container>

          <ng-container matColumnDef="RMresults.Message">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
              {{element.managerCallsResults.regionalMails}}
            </td>
          </ng-container>

          <ng-container matColumnDef="MSresults.WhatsApp">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f0fdf4">
              {{element.managerCallsResults.escortLetters}}
            </td>
          </ng-container>

          <ng-container matColumnDef="RMresults.WhatsApp">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
            <td mat-cell *matCellDef="let element" (click)="openCallsDates(element)" style="background-color: #f5fdf0">
              {{element.managerCallsResults.regionalLetters}}
            </td>
          </ng-container>

          <ng-container matColumnDef="MSresults.Share">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f0fdf4">МС</th>
            <td [style.background]="element.callPlan.escortManagerCalls <= element.managerCallsResults.escortTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
              {{element.managerCallsResults.escortRes}}
            </td>
          </ng-container>

          <ng-container matColumnDef="RMresults.Share">
            <th mat-header-cell *matHeaderCellDef style="background-color: #f5fdf0">РМ</th>
            <td [style.background]="element.callPlan.regionalManagerCalls <= element.managerCallsResults.regionalTotalContacts ? '#b2fab4' : 'transparent'" mat-cell *matCellDef="let element" (click)="openCallsDates(element)">
              {{element.managerCallsResults.regionalRes}}
            </td>
          </ng-container>

          <ng-container matColumnDef="colum1">
            <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(0)}}</th>
            <td mat-cell *matCellDef="let element" colspan="4">
              <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type != 1" [value]="element.directions.table1" (focusout)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)"></textarea>

              <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table1Type == 1" [(ngModel)]="element.directions.table1Optin" (change)="setData($event.currentTarget.value,  element.directions.table1Id, element.id)">
                <option *ngFor="let table1Optin of element.directions.table1Optins; let i = index" [value]="i">{{table1Optin}}</option>
              </select>
            </td>
          </ng-container>

          <ng-container matColumnDef="colum2">
            <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(1)}}</th>
            <td mat-cell *matCellDef="let element" colspan="4">
              <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type != 1" [value]="element.directions.table2" (focusout)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)"></textarea>

              <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table2Type == 1" [(ngModel)]="element.directions.table2Optin" (change)="setData($event.currentTarget.value,  element.directions.table2Id, element.id)">
                <option *ngFor="let table2Optin of element.directions.table2Optins; let i = index" [value]="i">{{table2Optin}}</option>
              </select>
            </td>
          </ng-container>

          <ng-container matColumnDef="colum3">
            <th mat-header-cell *matHeaderCellDef colspan="4">{{getTableName(2)}}</th>
            <td mat-cell *matCellDef="let element" colspan="4">
              <textarea style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type != 1" [value]="element.directions.table3" (focusout)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)"></textarea>

              <select style="width:auto;border:none;background:none;" *ngIf="element.directions.table3Type == 1" [(ngModel)]="element.directions.table3Optin" (change)="setData($event.currentTarget.value,  element.directions.table3Id, element.id)">
                <option *ngFor="let table3Optin of element.directions.table3Optins; let i = index" [value]="i">{{table3Optin}}</option>
              </select>
            </td>
          </ng-container>

          <ng-container matColumnDef="filler">
            <th mat-header-cell *matHeaderCellDef
                [style.text-align]="center"
                [attr.colspan]="6"
                style="background-color: #fff"></th>
          </ng-container>

          <ng-container matColumnDef="allCalls">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="3" style="text-align: center; background-color: #ffe8ff; color: #9e7cae">Звонки </th>
          </ng-container>

          <ng-container matColumnDef="trips">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e6efff; color: #bcc1df">Команд. </th>
          </ng-container>

          <ng-container matColumnDef="todos">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="10" style="text-align: center; background-color: #d7f5ff; color: #94c3cb">План и факт по задачам - {{getTypeManager() == 10 ? "МС" : getTypeManager() == 20 ? "РМ"  : "--"}} - {{manager.login}}</th>
          </ng-container>

          <ng-container matColumnDef="allResultsAndMsg">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Итого</th>
          </ng-container>

          <ng-container matColumnDef="allResults">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки 2.5 мин</th>
          </ng-container>

          <ng-container matColumnDef="calls">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Звонки - развития</th>
          </ng-container>

          <ng-container matColumnDef="Message">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Письма </th>
          </ng-container>

          <ng-container matColumnDef="WhatsApp">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">WhatsApp</th>
          </ng-container>

          <ng-container matColumnDef="Share">
            <th mat-header-cell *matHeaderCellDef [attr.colspan]="2" style="text-align: center; background-color: #e9fff2; color: #8db39a">Доля %</th>
          </ng-container>

          <tr class="sub-header" mat-header-row *matHeaderRowDef="['filler', 'allCalls', 'trips', 'todos', 'allResultsAndMsg', 'allResults', 'calls', 'Message', 'WhatsApp', 'Share']" style="height: 30px"></tr>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;" (dblclick)="openEditClientForm(row)"></tr>
        </table>

      </mat-card-content>
    </div>
</mat-card>

